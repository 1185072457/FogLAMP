#!/bin/bash

set -e

if [ "$debian_chroot" != 'classic' ]; then
  echo "FogLAMP must run in classic mode. Type \"sudo classic\" first and run this command again."
  exit 1
fi

if [ "$USER" == 'foglamp' ]; then
  if [ "$HOME" == '/home/foglamp' ]; then
    exit 0
  else
    echo "This version of FogLAMP can be executed only if the home directory of the user \"foglamp\" is \"/home/foglamp\""
    exit 1
  fi
else
  echo "This version of FogLAMP can be executed only by the user \"foglamp\" in sudo classic mode"
  exit 1
fi

echo "Installing FogLAMP..."

# Copy executables in the bin directory
cp ${HOME}/FogLAMP/extras/bin/* ${HOME}/bin/.

# Build the environment
cd ${HOME}/FogLAMP/src/python
source build.sh -i
source build.sh -a

echo "Installation Completed."
exit 0
